<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title></title>
    <link href="../styles/bootstrap.css" rel="stylesheet">
    <link href="../styles/bootstrap-theme.css" rel="stylesheet">
    <link href="../styles/font-awesome.css" rel="stylesheet">
    <script src="../js/lib/jquery/jquery-1.10.2.js"></script>
    <script src="../js/lib/bootstrap/bootstrap.js"></script>
    <script src="../js/lib/chartjs/chart.js"></script>
    <style>
        h4{
            margin-left:100px;
            vertical-align: middle;
            float:left;
        }
        .choose{
            float:left;
            width:100px;
            height:30px;
            margin-left:50px;
            margin-top:5px;
            border-radius:5px;
        }
        .canvas{
            margin-left:50px;
            width:650px;
            height:350px;
        }
    </style>
    <script>
        $(function(){
            //var arr=[];
            console.log($("option:selected").val());
            $.ajax({
                "url": "canteen.php",
                "type": "post",
                success: function (_data) {
                    var str = eval(_data);
                    var lineChartData= {
                        labels : [],
                        datasets : [
                            {
                                label: "My First dataset",
                                fillColor : "rgba(220,220,220,0.2)",
                                strokeColor : "#F38630",
                                pointColor : "lightblue",
                                pointStrokeColor : "#fff",
                                pointHighlightFill : "#fff",
                                pointHighlightStroke : "rgba(220,220,220,1)",
                                data : []
                            },
                        ]
                    }
                    for (var i = 0; i < 31; i++) {
                        //arr.push(str[i].time);
                        lineChartData.labels.push(str[i].canteendate01);
                        //console.log(str[i].date);
                    }
                    for (var j = 0; j < 31; j++) {
                        //arr.push(str[i].time);
                        // console.log(str[j].number)
                        lineChartData.datasets[0].data.push(str[j].canteennumber01);
                        // lineChartData.datasets[1].data.push(str[j].number02);
                    }
                    $("#demo").html("<canvas id='canvas2' class='canvas'></canvas>")
                    var ctx = document.getElementById("canvas2").getContext("2d");
                    window.myLine = new Chart(ctx).Line(lineChartData, {
                        responsive : true
                    });
                }
            });
            $("select").change(function(){
                $.ajax({
                    "url": "canteen.php",
                    "type": "post",
                    success: function (_data) {
                        var str = eval(_data);
                        console.log();
                        var lineChartData1 = {
                            labels : [],
                            datasets : [
                                {
                                    label: "My First dataset",
                                    fillColor : "rgba(220,220,220,0.2)",
                                    strokeColor : "#F38630",
                                    pointColor : "lightblue",
                                    pointStrokeColor : "#fff",
                                    pointHighlightFill : "#fff",
                                    pointHighlightStroke : "rgba(220,220,220,1)",
                                    data : []
                                },
                            ]
                        }
                        if($("option:selected").val()=="201502"){
                            for (var i = 0; i < 28; i++) {
                                //arr.push(str[i].time);
                                lineChartData1.labels.push(str[i].canteendate02);
                                //console.log(str[i].date);
                            }
                            for (var j = 0; j < 28; j++) {
                                //arr.push(str[i].time);
                                // console.log(str[j].number)
                                lineChartData1.datasets[0].data.push(str[j].canteennumber02);
                            }
                        }
                        else if($("option:selected").val()=="201503"){
                            for (var a = 0; a < 31; a++) {
                                //arr.push(str[i].time);
                                lineChartData1.labels.push(str[a].canteendate03);
                                //console.log(str[i].date);
                            }
                            for (var b = 0; b < 31; b++) {
                                //arr.push(str[i].time);
                                // console.log(str[j].number)
                                lineChartData1.datasets[0].data.push(str[b].canteennumber03);
                            }
                        }
                        else if($("option:selected").val()=="201504"){
                            for (var a = 0; a < 30; a++) {
                                //arr.push(str[i].time);
                                lineChartData1.labels.push(str[a].canteendate04);
                                //console.log(str[i].date);
                            }
                            for (var b = 0; b < 30; b++) {
                                //arr.push(str[i].time);
                                // console.log(str[j].number)
                                lineChartData1.datasets[0].data.push(str[b].canteennumber04);
                            }
                        }
                        else if($("option:selected").val()=="201505"){
                            for (var a = 0; a < 31; a++) {
                                //arr.push(str[i].time);
                                lineChartData1.labels.push(str[a].canteendate05);
                                //console.log(str[i].date);
                            }
                            for (var b = 0; b < 31; b++) {
                                //arr.push(str[i].time);
                                // console.log(str[j].number)
                                lineChartData1.datasets[0].data.push(str[b].canteennumber05);
                            }
                        }
                        else if($("option:selected").val()=="201506"){
                            for (var a = 0; a < 30; a++) {
                                //arr.push(str[i].time);
                                lineChartData1.labels.push(str[a].canteendate06);
                                //console.log(str[i].date);
                            }
                            for (var b = 0; b < 30; b++) {
                                //arr.push(str[i].time);
                                // console.log(str[j].number)
                                lineChartData1.datasets[0].data.push(str[b].canteennumber06);
                            }
                        }
                        else if($("option:selected").val()=="201507"){
                            for (var a = 0; a < 31; a++) {
                                //arr.push(str[i].time);
                                lineChartData1.labels.push(str[a].canteendate07);
                                //console.log(str[i].date);
                            }
                            for (var b = 0; b < 31; b++) {
                                //arr.push(str[i].time);
                                // console.log(str[j].number)
                                lineChartData1.datasets[0].data.push(str[b].canteennumber07);
                            }
                        }
                        else if($("option:selected").val()=="201508"){
                            for (var a = 0; a < 31; a++) {
                                //arr.push(str[i].time);
                                lineChartData1.labels.push(str[a].canteendate08);
                                //console.log(str[i].date);
                            }
                            for (var b = 0; b < 31; b++) {
                                //arr.push(str[i].time);
                                // console.log(str[j].number)
                                lineChartData1.datasets[0].data.push(str[b].canteennumber08);
                            }
                        }
                        else if($("option:selected").val()=="201509"){
                            for (var a = 0; a < 30; a++) {
                                //arr.push(str[i].time);
                                lineChartData1.labels.push(str[a].canteendate09);
                                //console.log(str[i].date);
                            }
                            for (var b = 0; b < 30; b++) {
                                //arr.push(str[i].time);
                                // console.log(str[j].number)
                                lineChartData1.datasets[0].data.push(str[b].canteennumber09);
                            }
                        }
                        else if($("option:selected").val()=="201510"){
                            for (var a = 0; a < 31; a++) {
                                //arr.push(str[i].time);
                                lineChartData1.labels.push(str[a].canteendate10);
                                //console.log(str[i].date);
                            }
                            for (var b = 0; b < 31; b++) {
                                //arr.push(str[i].time);
                                // console.log(str[j].number)
                                lineChartData1.datasets[0].data.push(str[b].canteennumber10);
                            }
                        }
                        else if($("option:selected").val()=="201511"){
                            for (var a = 0; a < 30; a++) {
                                //arr.push(str[i].time);
                                lineChartData1.labels.push(str[a].canteendate11);
                                //console.log(str[i].date);
                            }
                            for (var b = 0; b < 30; b++) {
                                //arr.push(str[i].time);
                                // console.log(str[j].number)
                                lineChartData1.datasets[0].data.push(str[b].canteennumber11);
                            }
                        }
                        else if($("option:selected").val()=="201512"){
                            for (var a = 0; a < 31; a++) {
                                //arr.push(str[i].time);
                                lineChartData1.labels.push(str[a].canteendate12);
                                //console.log(str[i].date);
                            }
                            for (var b = 0; b < 31; b++) {
                                //arr.push(str[i].time);
                                // console.log(str[j].number)
                                lineChartData1.datasets[0].data.push(str[b].canteennumber12);
                            }
                        }
                        else if($("option:selected").val()=="201501"){
                            for (var a = 0; a < 27; a++) {
                                //arr.push(str[i].time);
                                lineChartData1.labels.push(str[a].canteendate01);
                                //console.log(str[i].date);
                            }
                            for (var b = 0; b < 27; b++) {
                                //arr.push(str[i].time);
                                // console.log(str[j].number)
                                lineChartData1.datasets[0].data.push(str[b].canteennumber01);
                            }
                        }
                        $("#demo").html("<canvas id='canvas2' class='canvas'></canvas>")
                        var ctx = document.getElementById("canvas2").getContext("2d");

                        window.myLine = new Chart(ctx).Line(lineChartData1, {
                            responsive: true
                        });

                    }
                });
            })
        });
    </script>
</head>
<body>
<div style="width:800px;height:500px;">
    <h4>食堂2015年度用电量查询</h4>

    <select class="choose">
        <option>201501</option>
        <option>201502</option>
        <option>201503</option>
        <option>201504</option>
        <option>201505</option>
        <option>201506</option>
        <option>201507</option>
        <option>201508</option>
        <option>201509</option>
        <option>201510</option>
        <option>201511</option>
        <option>201512</option>
    </select>
    <br>
    <p style="display:block;margin-top:20px;margin-left:20px;" >单位：度</p>
    <div id="demo"></div>
</div>
<h5 style="margin-left:860px;">单位：日</h5>
</body>
</html>